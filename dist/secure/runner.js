(function(t){"use strict";function e(){i&&l.removeChild(i),i=u.createElement("iframe"),i.setAttribute("width","100%"),i.setAttribute("height",u.height),l.appendChild(i)}function n(t){e(),i.addEventListener("load",function(){s("load",null)},!1);var n=i.contentWindow.document;n.open(),n.write(t),n.close()}function s(e,n){var s=h.stringify({data:n,type:e,secret:c});t.top.postMessage(s,"*")}function a(t,e){t&&(t={message:t.message,stack:t.stack,type:t.type,arguments:t.arguments,errorType:(t.constructor+"").trim().match(/^function ([A-Z][a-zA-Z]+)/)[1]}),"function"==typeof e&&(e+=""),s("evaljs",{error:t,result:e})}function o(t){var e=i.contentWindow,n=null;try{n=e.eval(t)}catch(s){throw a(s,null),s}a(null,n)}function r(){s("html",i.contentWindow.document.documentElement.outerHTML)}var i,c,u=t.document,l=u.querySelector("body"),h=t.JSON,f={load:n,evaljs:o,html:r};t.addEventListener("message",function(t){var e;try{e=h.parse(t.data)}catch(n){return}var s=e.type,a=e.data;if(e.secret)if(c||"handshake"!==e.type){if(e.secret!==c)return;f[s](a)}else c=e.secret},!1),t.stuffEmit=function(t,e){s("custom",{type:t,data:e})}})(window);